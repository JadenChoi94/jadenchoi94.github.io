---
title: 'μΈμ¦(Authentication)'
excerpt: μΈμ¦μ— λ€ν•΄ μ΄ν•΄ν•κΈ°
categories:
    - Web

tag:
    - TIL
    - web
    

comments: true
last_modified_at: 2021-07-08T11:00:00+09:00
toc: true
---

![post-thumbnail](https://media.vlpt.us/images/suasue/post/de0a0d0f-8f0c-4fd0-bb89-8a23611f6248/authentication-software2.png)

[μ‚¬μ§„μ¶μ²](https://managementmania.com/en/authentication-software)

λ°±μ—”λ“ κ°λ°μλ΅μ„ νμ›κ°€μ…κ³Ό λ΅κ·ΈμΈ κΈ°λ¥ κµ¬ν„ μ‹ κΌ­ μ•μ•„μ•Ό ν•  μΈμ¦μ κ°λ…κ³Ό λΉ„λ°€λ²νΈ μ•”νΈν™” λ°©μ‹μ— λ€ν•΄μ„ μ•μ•„λ³΄λ„λ΅ ν•κ² λ‹¤.

## π¤™ μΈμ¦(Authentication)

### μΈμ¦μ΄λ€?

- μΈμ¦μ΄λ€ μ μ €κ°€ λ„κµ¬μΈμ§€(identification)λ¥Ό μ‹λ³„ν•λ” μ μ°¨
- μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈλ¥Ό ν™•μΈν•λ” μ μ°¨
- νμ›κ°€μ…κ³Ό λ΅κ·ΈμΈ

### μ–Έμ  μΈμ¦μ„ μ‚¬μ©ν• κΉ?

- μ°λ¦¬ μ„λΉ„μ¤λ¥Ό λ„κ°€ μ“°λ”μ§€, μ–΄λ–»κ² μ“°λ”μ§€ μ¶”μ ν•κ³  μ‹¶μ„ λ•

### μ–΄λ–¤ κ³Όμ •μΌλ΅ μ΄λ£¨μ–΄μ§κΉ?

1. μ μ € μ•„μ΄λ””μ™€ λΉ„λ² μƒμ„±
2. μ μ € λΉ„λ² μ•”νΈν™” ν•΄μ„ DBμ— μ €μ¥
3. μ μ € λ΅κ·ΈμΈ -> μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈ μ…λ ¥
4. μ μ €κ°€ μ…λ ¥ν• λΉ„λ°€λ²νΈ μ•”νΈν™”ν• ν›„ μ•”νΈν™”λμ„ DBμ— μ €μ •λ μ μ € λΉ„λ°€λ²νΈμ™€ λΉ„κµ
5. μΌμΉν•λ©΄ λ΅κ·ΈμΈ μ„±κ³µ
6. λ΅κ·ΈμΈ μ„±κ³µν•λ©΄ `access token`μ„ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅
7. μ μ €λ” λ΅κ·ΈμΈ μ„±κ³µν›„ λ‹¤μλ¶€ν„°λ” `access token`μ„ μ²¨λ¶€ν•΄μ„ requestλ¥Ό μ„λ²„μ— μ „μ†΅ν•¨μΌλ΅μ„ λ§¤λ² λ΅κ·ΈμΈ ν•΄λ„ λμ§€ μ•λ„λ΅ ν•λ‹¤.

------

## π”‘ λΉ„λ°€λ²νΈ μ•”νΈν™”

![img](https://media.vlpt.us/images/suasue/post/bef08a5e-0ca8-4810-b043-9613905d5d96/image.png)

[μ‚¬μ§„μ¶μ²](https://devlog-wjdrbs96.tistory.com/212)

- μΈμ¦μ— ν•„μ”ν• κ²ƒμ€ μ•„μ΄λ””, μ΄λ©”μΌμ£Όμ†, λΉ„λ°€λ²νΈ λ“±μ΄ μλ”λ°, μ΄ μ¤‘ κ°€μ¥ μ¤‘μ”ν• κ²ƒμ€ **λΉ„λ°€λ²νΈ**. λΉ„λ°€λ²νΈλ¥Ό μ•λ©΄ κ·Έ μ‚¬λμ κ°μΈμ •λ³΄μ— μ ‘κ·Όν•  μ μκΈ° λ•λ¬Έμ—
- λΉ„λ°€λ²νΈλ” κΌ­ **`μ•”νΈν™”`**ν•΄μ•Ό ν•λ‹¤.

### λΉ„λ°€λ²νΈλ¥Ό μ•”νΈν™”ν•΄μ„ μ €μ¥ν•΄μ•Ό ν•λ” μ΄μ 

- κ°μΈμ •λ³΄λ³΄νΈλ²•μ—μ„ κ·Έλ ‡κ² ν•λΌκ³  μ •ν•΄λ†“μ•λ‹¤.
- DBκ°€ ν•΄ν‚Ήμ„ λ‹Ήν•λ©΄ μ μ €μ λΉ„λ°€λ²νΈλ„ κ·Έλ€λ΅ λ…Έμ¶ λλ‹¤.
- μ™Έλ¶€ ν•΄ν‚Ήμ΄ μ•„λ‹λ”λΌλ„ λ‚΄λ¶€ κ°λ°μλ‚ μΈλ ¥μ΄ μ μ €λ“¤μ λΉ„λ°€λ²νΈλ¥Ό λ³Ό μ μλ‹¤.

(νμ΄μ¤λ¶μ—μ„  2019λ…„κΉμ§€λ„ μ‚¬μ©μμ λΉ„λ°€λ²νΈλ¥Ό ν‰λ¬ΈμΌλ΅ μ €μ¥ν•΄μ™”λ‹¤κ³  ν•λ‹¤.. [μ°Έκ³  κΈ°μ‚¬](https://www.boannews.com/media/view.asp?idx=78058&page=1&kind=1))

### λΉ„λ°€λ²νΈ μ•”νΈν™” μ‹κΈ°

1. DBμ—μ„ λΉ„λ°€λ²νΈ μ €μ¥ν•  λ• μ•”νΈν™”
   Databasesμ— μ €μ¥ μ‹ κ°μΈ μ •λ³΄λ¥Ό ν•΄μ‹±ν•μ—¬ λ³µμ›ν•  μ μ—†λ„λ΅ ν•λ‹¤.
   (λΉ„λ°€λ²νΈκ°€ μ΄λ―Έ λ°±μ—”λ“λ΅ λ„μ–΄κ°”μ„ λ•)
2. ν†µμ‹  μ‹ κ°μΈ μ •λ³΄λ¥Ό μ£Όκ³ λ°›μ„ λ• SSLμ„ μ μ©ν•μ—¬ μ•”νΈν™”(HTTPS) --> μ΄ λ¶€λ¶„μ€ λ”°λ΅ ν¬μ¤ν…ν•  μμ •
   (ν”„λ΅ νΈμ—μ„ λ°±μΌλ΅ ν…μ¤νΈκ°€ μ „λ‹¬λ  λ•)

------

## π”’ λΉ„λ°€λ²νΈλ¥Ό μ €μ¥ν•  λ• μ‚¬μ©ν•λ” μ•”νΈν™” λ°©μ‹

### λ‹¨λ°ν–¥ ν•΄μ‰¬ ν•¨μ

![img](https://media.vlpt.us/images/suasue/post/494aa426-81de-42c5-bb29-ddc00710c86e/image.png)

[μ‚¬μ§„μ¶μ²](https://velog.io/@nameunzz/λ‹¨λ°©ν–¥-ν•΄μ‹-ν•¨μ)

- λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μλ” μν•™μ μΈ μ—°μ‚°μ„ ν†µν•΄ μ›λ³Έ λ©”μ‹μ§€λ¥Ό λ³€ν™ν•μ—¬ μ•”νΈν™”λ λ©”μ‹μ§€μΈ λ‹¤μ΄μ μ¤νΈλ¥Ό μƒμ„±ν•λ‹¤. μ›λ³Έ λ©”μ‹μ§€λ¥Ό μ•λ©΄ μ•”νΈν™”λ λ©”μ‹μ§€λ¥Ό κµ¬ν•κΈ°λ” μ‰½μ§€λ§ μ•”νΈν™”λ λ©”μ‹μ§€λ΅λ” μ›λ³Έ λ©”μ‹μ§€λ¥Ό κµ¬ν•  μ μ—†μ–΄μ•Ό ν•λ©° μ΄λ¥Ό 'λ‹¨λ°©ν–¥μ„±'μ΄λΌκ³  ν•λ‹¤.
- μλ¥Ό λ“¤μ–΄ `army`λΌλ” ν¨μ¤μ›λ“λ¥Ό ν”ν μ“°μ΄λ” ν•΄μ‹ μ•κ³ λ¦¬μ¦ SHA-256μΌλ΅ μΈμ½”λ”©ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ κ²°κ³Όλ¥Ό μ–»μ„ μ μλ‹¤

```null
b2fd5cdba2b1484db46c26a3426f70878d2b31f44f18f806fd262f34887a6320
```

- λ€λ¶€λ¶„μ ν•΄μ‹ ν•¨μλ” μ…λ ¥ κ°’μ μΌλ¶€κ°€ λ³€κ²½λμ—μ„ λ• λ‹¤μ΄μ μ¤νΈκ°€ μ™„μ „ν λ‹¬λΌμ§€λ„λ΅ μ„¤κ³„λμ–΄ μλ‹¤. `army2`λΌλ” κ°’μ SHA-256 λ‹¤μ΄μ μ¤νΈλ” μ•„λμ™€ κ°™μΌλ©° μ„μ `army`μ™€λ” μ™„μ „ν λ‹¬λΌμ§„ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

```null
4d6ba57a1cbffa2fd4def7c2a0b74f1151971454659b78a833103c4e60d7da0d
```

- μ›λ³Έ λ©”μ‹μ§€λ¥Ό μ‚΄μ§λ§ λ°”κΎΈμ–΄λ„ κ²°κ³Όκ°€ ν¬κ² λ‹¬λΌμ§€λ” νΉμ§•μ„ avalanche ν¨κ³ΌλΌκ³  ν•λ©°, μ‚¬μ©μμ μ›λ³Έ ν¨μ¤μ›λ“λ¥Ό μ¶”λ΅ ν•κΈ° μ–΄λ µκ² λ§λ“λ” μ¤‘μ”ν• μ”μ†μ΄λ‹¤.

### λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μμ λ¬Έμ μ 

#### μΈμ‹ κ°€λ¥μ„±(recognizability)

- λ‹¨λ°ν–¥ ν•΄μ‰¬μ—λ” κ°™μ€ κ°’μ„ ν•΄μ‹±ν•λ©΄ ν•­μƒ κ°™μ€ λ‹¤μ΄μ μ¤νΈκ°€ λ‚μ¨λ‹¤λ” ν—μ μ΄ μ΅΄μ¬ν•λ‹¤. μ΄ νΉμ„±μ„ μ΄μ©ν•΄μ„ κ°€λ¥ν• κ²½μ°μ μλ¥Ό λ―Έλ¦¬ ν•΄μ‹κ°’μΌλ΅ λ§λ“¤μ–΄ λ†“μ€ ν…μ΄λΈ”μ„ λ μΈλ³΄μ° ν…μ΄λΈ”(rainbow table)μ΄λΌκ³  ν•λ‹¤. λ μΈλ³΄μ° ν…μ΄λΈ”μ„ μ΄μ©ν• κ³µκ²© λ°©μ‹μ„ **λ μΈλ³΄μ° ν…μ΄λΈ” κ³µκ²©(rainbow table attack)**μ΄λΌ ν•λ‹¤.

#### μ†λ„(Speed)

- ν•΄μ‹ ν•¨μλ” μ›λ μ§§μ€ μ‹κ°„μ— λ°μ΄ν„°λ¥Ό κ²€μƒ‰ν•κΈ° μ„ν•΄ μ„¤κ³„λ κ²ƒμ΄λ‹¤. ν•΄μ‹ ν•¨μμ λΉ λ¥Έ μ²λ¦¬ μ†λ„λ΅ μΈν•΄ κ³µκ²©μλ” λ§¤μ° λΉ λ¥Έ μ†λ„λ΅ μ„μμ λ¬Έμμ—΄μ λ‹¤μ΄μ μ¤νΈμ™€ ν•΄ν‚Ήν•  λ€μƒμ λ‹¤μ΄μ μ¤νΈλ¥Ό λΉ„κµν•  μ μλ‹¤. μ΄λ¥Ό **λ¬΄μ°¨λ³„ λ€μ…κ³µκ²©(brute-force attack)**λΌκ³  ν•λ‹¤.
- μ΄λ° λ°©μ‹μΌλ΅ ν¨μ¤μ›λ“λ¥Ό μ¶”μΈ΅ν•λ©΄ ν¨μ¤μ›λ“κ°€ μ¶©λ¶„ν κΈΈκ±°λ‚ λ³µμ΅ν•μ§€ μ•μ€ κ²½μ°μ—λ” κ·Έλ¦¬ κΈ΄ μ‹κ°„μ΄ κ±Έλ¦¬μ§€ μ•λ”λ‹¤.

### λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μ λ³΄μ™„ν•κΈ°

![img](https://media.vlpt.us/images/suasue/post/d74b8b99-0e10-4c37-9780-19f429596b3c/image.png)

#### μ†”ν…(Salting)

- μ†”ν…(Salting)μ€ μ‹¤μ  λΉ„λ°€λ²νΈ μ΄μ™Έμ— μ¶”κ°€μ μΌλ΅ λλ¤ λ°μ΄ν„°(Salt)λ¥Ό λ”ν•΄μ„ ν•΄μ‹κ°’μ„ κ³„μ‚°ν•λ” λ°©λ²•μ΄λ‹¤.
- μ΄ λ°©λ²•μ„ μ‚¬μ©ν•λ©΄, κ³µκ²©μκ°€ μ‹¤μ  ν¨μ¤μ›λ“μ λ‹¤μ΄μ μ¤νΈλ¥Ό μ•μ•„λ‚΄λ”λΌλ„ μ†”ν…λ λ‹¤μ΄μ μ¤νΈλ¥Ό λ€μƒμΌλ΅ ν¨μ¤μ›λ“ μΌμΉ μ—¬λ¶€λ¥Ό ν™•μΈν•κΈ° μ–΄λ µλ‹¤. λν• μ‚¬μ©μλ³„λ΅ λ‹¤λ¥Έ μ†”νΈλ¥Ό μ‚¬μ©ν•λ‹¤λ©΄ λ™μΌν• ν¨μ¤μ›λ“λ¥Ό μ‚¬μ©ν•λ” μ‚¬μ©μμ λ‹¤μ΄μ μ¤νΈκ°€ λ‹¤λ¥΄κ² μƒμ„±λμ–΄ μΈμ‹ κ°€λ¥μ„± λ¬Έμ κ°€ ν¬κ² κ°μ„ λλ‹¤.
- λ μΈλ³΄μ° ν…μ΄λΈ” κ³µκ²©(rainbow table attack)μ„ λ§‰μ„ μ μλ‹¤.

#### ν‚¤ μ¤νΈλ μΉ­(Key Stretching)

- ν‚¤ μ¤νΈλ μΉ­(Key Stretching)μ€ ν•΄μ‰¬ κ°’μ„ μ—¬λ¬λ² λ°λ³µν•΄μ„ ν•΄μ‹ ν•λ” ν–‰μ„μ΄λ‹¤.
- μ…λ ¥ν• ν¨μ¤μ›λ“λ¥Ό λ™μΌν• νμλ§νΌ ν•΄μ‹ν•΄μ•Όλ§ μ…λ ¥ν• ν¨μ¤μ›λ“μ μΌμΉ μ—¬λ¶€λ¥Ό ν™•μΈν•  μ μλ‹¤.
- μΌλ°μ μΈ μ¥λΉ„λ΅ 1μ΄μ— 50μ–µ κ° μ΄μƒμ λ‹¤μ΄μ μ¤νΈλ¥Ό λΉ„κµν•  μ μμ§€λ§, ν‚¤ μ¤νΈλ μΉ­μ„ μ μ©ν•μ—¬ λ™μΌν• μ¥λΉ„μ—μ„ 1μ΄μ— 5λ² μ •λ„λ§ λΉ„κµν•  μ μκ² ν•λ‹¤.
- λ¬΄μ°¨λ³„ λ€μ…κ³µκ²©(brute-force attack)μ„ λ§‰μ„ μ μλ‹¤.

> ### μ–‘λ°©ν–¥ μ•”νΈν™”λ” μ–Έμ  μ“°μ΄λ‚?
>
> μ–‘λ°©ν–¥ μ•”νΈν™”λ” λ°±μ—”λ“ κ°λ°μκ°€ μ•”νΈν™”ν•΄μ„ μ €μ¥ν•΄μ•Ό ν•λ” λ―Όκ°ν• μ •λ³΄μ΄λ‚ λ‹¤μ‹ λ³µνΈν™”ν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” κ²½μ°μ— μ‚¬μ©λλ‹¤.
> μλ¥Ό λ“¤μ–΄ λ³‘μ› μ‹μ¤ν…μ—μ„ μ£Όλ―Όλ“±λ΅λ²νΈλ” λ―Όκ°ν• μ •λ³΄μ΄κΈ΄ ν•λ‚ μμ£Ό μ‚¬μ©ν•΄μ•Ό ν•λ―€λ΅ λ³µνΈν™”ν•  μ μμ–΄μ•Ό ν•λ‹¤. λν•, μΏ ν΅μ—μ„ μ‰½κ² κ²°μ ν•  μ μλ” μ΄μ λ„ μ‹ μ©μΉ΄λ“ μ •λ³΄λ¥Ό μ–‘λ°©ν–¥ μ•”νΈν™”λ΅ μ €μ¥ν•΄λ‘μ—κΈ° λ•λ¬Έμ΄λ‹¤. μ—„κ²©ν•κ² ν•λ” κ³³μ€ μ£Όμ†λ„ μ–‘λ°©ν–¥ μ•”νΈν™” ν•΄λ‘κΈ°λ„ ν•λ‹¤.

------

## π” bcrypt

- bcryptλ” λ‹¨λ°©ν–¥ ν•΄μ‰¬ ν•¨μλ΅ μ•”νΈν™”ν•  λ• μ‚¬μ©ν•λ” λ€ν‘μ μΈ λΌμ΄λΈλ¬λ¦¬μ΄λ‹¤. Saltingκ³Ό Key Stretching μ μ©μ„ νΈν•κ² ν•΄μ¤€λ‹¤.
- bcryptλ” hashκ²°κ³Όκ°’μ— μ†κΈκ°’κ³Ό ν•΄μ‹κ°’ λ° λ°λ³µνμλ¥Ό κ°™μ΄ λ³΄κ΄€ν•κΈ° λ•λ¬Έμ— λΉ„λ°€λ²νΈ ν•΄
  μ‹±μ„ μ μ©ν•λ”λ° μμ–΄ DBμ„¤κ³„λ¥Ό λ³µμ΅ν•κ² ν•  ν•„μ”κ°€ μ—†λ‹¤.
- bcryptλ¥Ό ν†µν•΄ ν•΄μ‹±λ κ²°κ³Ό κ°’(Digest)μ κµ¬μ΅°λ” μ•„λμ™€ κ°™λ‹¤.
  ![img](https://media.vlpt.us/images/suasue/post/7bba9af7-84c8-4ee0-9c01-05543bef9e26/image.png)

### bcrypt μ‚¬μ©ν•κΈ°

bcryptλ¥Ό μ„¤μΉν•λ‹¤.

```python
pip install bcrypt 
```

bcryptλ¥Ό importν•λ‹¤.

```python
import bcrypt
```

#### λΉ„λ°€λ²νΈ μ•”νΈν™”ν•κΈ°

bcryptλ” `str`λ°μ΄ν„°κ°€ μ•„λ‹ `bytes` λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ‹¤.
`str` μ„ encodeν•΄μ„ `bytes`λ΅ λ§λ“¤μ–΄ μ¤€λ‹¤.(λ°λ€λ” decodeμ΄λ‹¤.)
encode μ‹μ—λ” μ°λ¦¬κ°€ μΈμ‹ν•  μ μλ” ν•νƒλ΅ λ³€ν™ν•κΈ° μ„ν•΄ `UTF-8` μ λ‹μ½”λ“ λ¬Έμ κ·κ²©μ„ μ‚¬μ©ν•λ‹¤.

```python
password = '1234'
encoded_password = password.encode('utf-8')
```

`bcrypt.hashpw()` λ©”μ†λ“λ” (bytes ν•μ‹μ ν¨μ¤μ›λ“, μ†κΈκ°’)μ„ μΈμλ΅ λ°›μ•„ ν•΄μ‹±λ λΉ„λ°€λ²νΈλ¥Ό λ§λ“ λ‹¤.
`bcrypt.gensalt()` λ©”μ†λ“λ΅ λλ¤ν• μ†κΈκ°’μ„ μƒμ„±ν•  μ μλ‹¤.

```python
hashed_password = bcrypt.hashpw(encoded_password, bcrypt.gensalt())
```

`print()`λ΅ ν™•μΈν•΄λ³΄μ. μ•”νΈν™”λ λ°μ΄ν„°μ νƒ€μ…μ€ Bytesμ΄λ‹¤.

```python
print(hashed_password)
b'$2b$12$YFs9rh.1LgJwZuf9ibyjpuLvBoCaGX0MzedFWF2Jo0zU3lMZurZ4a'

type(hashed_password)
<class 'bytes'>
```

#### λΉ„λ°€λ²νΈ ν™•μΈν•κΈ°

`bcrypt.checkpw()` λ©”μ†λ“λ΅ μ…λ ¥λ λΉ„λ°€λ²νΈκ°€ λ§λ”μ§€ ν™•μΈν•  μ μλ‹¤. (μ…λ ¥λ°›μ€ ν¨μ¤μ›λ“, μ €μ¥λ μ•”νΈν™”λ ν¨μ¤μ›λ“)λ¥Ό κ°κ° μΈμλ΅ λ°›λ”λ‹¤. μΌμΉν•λ©΄ Trueλ¥Ό λ°ν™ν•λ‹¤.

```python
new_password = '1234'
bcrypt.checkpw(new_password.encode('utf-8'),hashed_password)
True
```

> μ°Έκ³ μ‚¬μ΄νΈ
> https://d2.naver.com/helloworld/318732
> https://st-lab.tistory.com/100
> https://k0102575.github.io/articles/2020-03/hash
> https://velog.io/@nameunzz/λ‹¨λ°©ν–¥-ν•΄μ‹-ν•¨μ
> https://velog.io/@hwang-eunji/backend-django-λΉ„λ°€λ²νΈ-μ•”νΈν™”-κµ¬ν„